<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Kahooona Project</title>
  <style>
    body { font-family: system-ui, sans-serif; max-width: 900px; margin: 40px auto; padding: 0 20px; line-height: 1.6; background: #fdfdfd; color: #222; }
    h1 { text-align: center; margin-bottom: 2rem; }
    h2 { text-align: center; color: #444; margin: 2rem 0 1rem; }
    ul { list-style: none; padding: 0; }
    li { margin: 1rem 0; padding: 1rem; background: white; border: 1px solid #eee; border-radius: 6px; }
    li:hover { border-color: #ccc; box-shadow: 0 2px 8px rgba(0,0,0,0.06); }
    a { color: #0066cc; text-decoration: none; font-weight: 500; font-size: 1.2em; }
    a:hover { text-decoration: underline; }
    .desc { color: #555; font-size: 0.95em; margin-top: 0.3em; }
    .error { color: #c00; text-align: center; }
    .note { text-align: center; color: #777; margin-top: 4rem; font-size: 0.9em; }
  </style>
</head>
<body>

  <h1>The Kahooona Project</h1>

  <h2>Projects</h2>

  <ul id="project-list">
    <li>Loading projects...</li>
  </ul>

  <p class="note">Projects are auto-listed from the /projects folder â€¢ Add new folders/files there</p>

  <script>
    fetch('https://api.github.com/repos/thekahoonaproject/thekahoonaproject.github.io/contents/projects')
      .then(res => res.json())
      .then(data => {
        const list = document.getElementById('project-list');
        list.innerHTML = '';

        if (data.message) { // error like Not Found
          list.innerHTML = '<li class="error">Could not load projects folder.<br>Check if /projects exists in the repo.</li>';
          return;
        }

        data.forEach(item => {
          if (item.type !== 'file' && item.type !== 'dir') return; // skip other types

          const li = document.createElement('li');
          const a = document.createElement('a');

          let displayName = item.name
            .replace(/[-_]/g, ' ')
            .replace(/\.[^/.]+$/, "")          // remove .html extension if present
            .replace(/\b\w/g, c => c.toUpperCase());

          if (item.type === 'dir') {
            a.href = `projects/${item.name}/`;   // assumes folder has index.html
            a.textContent = displayName || item.name;
            const desc = document.createElement('div');
            desc.className = 'desc';
            desc.textContent = 'Project folder';
            li.appendChild(a);
            li.appendChild(desc);
          } else if (item.name.endsWith('.html')) {
            a.href = `projects/${item.name}`;
            a.textContent = displayName || item.name;
            const desc = document.createElement('div');
            desc.className = 'desc';
            desc.textContent = 'Standalone HTML page';
            li.appendChild(a);
            li.appendChild(desc);
          } else {
            return; // skip non-html files
          }

          list.appendChild(li);
        });

        if (list.children.length === 0) {
          list.innerHTML = '<li>No HTML files or subfolders found in /projects yet.</li>';
        }
      })
      .catch(err => {
        document.getElementById('project-list').innerHTML = 
          '<li class="error">Failed to load project list.<br>(GitHub API issue or rate limit)</li>';
        console.error(err);
      });
  </script>

</body>
</html>
